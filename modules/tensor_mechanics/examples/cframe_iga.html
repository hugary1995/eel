<!DOCTYPE html><head><meta charset="UTF-8"><title>Isogeometric Analysis in MOOSE | Eel</title><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Eel</a><a href="https://github.com/hugary1995/eel" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../../eel.html">Documentation</a></li></ul><a href="#" class="sidenav-trigger" data-target="0bb6de53-a76d-407d-85fc-d839224170cc"><i class="material-icons">menu</i></a><ul class="sidenav" id="0bb6de53-a76d-407d-85fc-d839224170cc"><li><a href="../../../eel.html">Documentation</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">modules</span><a href=".." class="breadcrumb">tensor_mechanics</a><span class="breadcrumb">examples</span><a href="#" class="breadcrumb">cframe_iga</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="bab2e019-a9f8-41b6-8d91-4934734126ef" data-section-level="1" data-section-text="Isogeometric Analysis in MOOSE"><h1 id="isogeometric-analysis-in-moose">Isogeometric Analysis in MOOSE</h1><p>This example illustrates using <span>Isogeometric Analysis (IGA)</span> within MOOSE framework to perform a simulation. This example simulates  loads applied to a &quot;c-frame&quot; to determine the maximum principal stress.</p><section class="scrollspy" id="bb92263f-6611-411d-aa03-59eb083ca2da" data-section-level="2" data-section-text="Creating IGA Mesh"><h2 id="creating-iga-mesh">Creating IGA Mesh</h2><p>To create the mesh file included in this example a Coreform Cubit license is needed. Coreform Cubit is a product released and maintained by Coreform, LLC.  A free to use <a href="https://coreform.com/products/coreform-cubit/free-meshing-software/">Cubit Learn license</a> can be acquired.</p><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">comment</i><span class="moose-alert-title-brand">note:</span>Mesh Generation with Cubit</div><div class="card-content"><div class="moose-alert-content"><p>The following is not required to run the example, but is required to generate the input mesh that is included in the example. To execute the Cubit journal file in batch from the command line use the following command:</p><pre class="moose-pre"><code class="language-text">
coreform_cubit -batch cframe_build.jou
</code></pre></div></div></div><p>Within the journal file, see <a class="moose-float-reference" href="#cframe_jou">Listing 1</a>, there are unique commands that will generate a uspline on the discretized mesh. </p><ul class="browser-default"><li><p>Line 35 sets the degree and continuity of the uspline </p></li><li><p>As of this writing, the max degree supported by libmesh is 2. </p></li><li><p>All continuity must equal p-1 where p is the degree. </p></li><li><p>Line 36 constructs the uspline using the geometry as a basis. </p></li><li><p>Line 37 fits the uspline that was built to the geometry.</p></li></ul><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Listing 1: </span><span class="moose-caption-text" id="cframe_jou">Complete Coreform Cubit file for generating <span class="tooltipped" data-tooltip="Isogeometric Analysis" data-position="top" data-delay="50">IGA</span> input mesh</span></p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">import step &quot;c-frame.step&quot; heal
remove surface 15 17 21 19 22 23 16 25 18 20 24 26 14 35 38 33 34 36 37 7 8 4 5 6 1 2 10 12 3 9 13 11 80 77 81 88 79 86 90 78 76 89 87 75 91 85 29 28 30 27 31 32 62 60 57 58 48 45 47 50 49 46 54 53 51 56 52 55 41 39 42 43 40 44 68 66  extend 
remove surface 93  extend 
remove surface 94  extend 
webcut volume 1  with sheet extended from surface 99 98 96  preview 
webcut volume 1  with sheet extended from surface 99 98 96  
webcut volume all with sheet extended from surface 92 59  
webcut volume 6 4 3 5 1 2  with sheet extended from surface 67 61  
webcut volume 1 16 2 15  with plane vertex 52  vertex 215  vertex 10  preview 
webcut volume 1 16 2 15  with plane vertex 52  vertex 215  vertex 10  
create vertex on curve 14  fraction 0.5 from start 
create vertex on curve 77  fraction 0.5 from start 
create vertex on curve 32  fraction 0.5 from start 
webcut volume 16 2 15  with plane vertex 270  vertex 269  vertex 271  
webcut volume 1  with plane vertex 270  vertex 269  vertex 271  preview 
webcut volume 1  with plane vertex 270  vertex 269  vertex 271  
delete Vertex 271 269 270
imprint all 
merge all
volume all redistribute nodes off 
volume all scheme Sweep Vector 1 0 0 
volume all scheme Sweep Vector 1 0 0 sweep transform least squares 
volume all autosmooth target on  fixed imprints off  smart smooth off 
volume all size 0.5
mesh volume all
block 1 vol all
sideset 2 surf 194 203 196 
sideset 3 Surface 146 155 148 
block 1 element type hex27 #Quadratic FEA elements
export mesh &quot;CFrame_FEA_05_deg2.e&quot;  overwrite #FEA Export
set uspline vol all deg 2 cont 1
build uspline vol all as 1
fit uspline 1
export uspline 1 exodus &quot;CFrame_IGA_05&quot;
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#0331ba96-9ca8-4cfb-bd24-d05f1d6f74c7">(moose/modules/tensor_mechanics/examples/cframe_iga/cframe_build.jou)</a></div></div></section><section class="scrollspy" id="ac8fc733-27d0-4a22-a8eb-17d087c3efc7" data-section-level="2" data-section-text="MOOSE - IGA Simulation"><h2 id="moose-iga-simulation">MOOSE-IGA Simulation</h2><p>Performing the simulation utilizing the mesh created above does not require much with respect to the MOOSE input, simply  load the mesh from a file and select utilize the RATIONAL_BERNSTEIN element family as shown in <a class="moose-float-reference" href="#moose-iga-input">Listing 2</a>. Exporting using the VTK format (<code>vtk = true</code>) input will output in a format that will capture the higher-order nature  of the <span class="tooltipped" data-tooltip="Isogeometric Analysis" data-position="top" data-delay="50">IGA</span> based elements using Paraview visualization. </p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Listing 2: </span><span class="moose-caption-text" id="moose-iga-input">Complete input file for running example problem with <span class="tooltipped" data-tooltip="Isogeometric Analysis" data-position="top" data-delay="50">IGA</span> in MOOSE.</span></p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Mesh]
  [igafile]
    type = FileMeshGenerator
    file = cframe_iga_coarse.e
    clear_spline_nodes = true
  []
[]

[Variables]
  [disp_x]
    order = SECOND
    family = RATIONAL_BERNSTEIN
  []
  [disp_y]
    order = SECOND
    family = RATIONAL_BERNSTEIN
  []
  [disp_z]
    order = SECOND
    family = RATIONAL_BERNSTEIN
  []
[]

[Kernels]
  [TensorMechanics]
#Stress divergence kernels
    displacements = &#x27;disp_x disp_y disp_z&#x27;
   []
[]

[AuxVariables]
    [von_mises]
        #Dependent variable used to visualize the von Mises stress
       order = SECOND
       family = MONOMIAL
    []
    [Max_Princ]
       #Dependent variable used to visualize the Hoop stress
       order = SECOND
       family = MONOMIAL
    []
    [stress_xx]
        order = SECOND
        family = MONOMIAL
    []
    [stress_yy]
        order = SECOND
        family = MONOMIAL
    []
    [stress_zz]
        order = SECOND
        family = MONOMIAL
    []
[]

[AuxKernels]
  [von_mises_kernel]
    #Calculates the von mises stress and assigns it to von_mises
    type = RankTwoScalarAux
    variable = von_mises
    rank_two_tensor = stress
    scalar_type = VonMisesStress
  []
  [MaxPrin]
    type = RankTwoScalarAux
    variable = Max_Princ
    rank_two_tensor = stress
    scalar_type = MaxPrincipal
  []
  [stress_xx]
    type = RankTwoAux
    index_i = 0
    index_j = 0
    rank_two_tensor = stress
    variable = stress_xx
  []
    [stress_yy]
    type = RankTwoAux
    index_i = 1
    index_j = 1
    rank_two_tensor = stress
    variable = stress_yy
  []
  [stress_zz]
    type = RankTwoAux
    index_i = 2
    index_j = 2
    rank_two_tensor = stress
    variable = stress_zz
  []
[]

[BCs]
  [Pressure]
    [load]
      #Applies the pressure
      boundary = &#x27;3&#x27;
      factor = 2000 # psi
    []
  []
  [anchor_x]
    #Anchors the bottom and sides against deformation in the x-direction
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;2&#x27;
    value = 0.0
  []
  [anchor_y]
    #Anchors the bottom and sides against deformation in the y-direction
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;2&#x27;
    value = 0.0
  []
  [anchor_z]
    #Anchors the bottom and sides against deformation in the z-direction
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;2&#x27;
    value = 0.0
  []
[]

[Materials]
  [elasticity_tensor_AL]
    #Creates the elasticity tensor using concrete parameters
    youngs_modulus = 24e6 #psi
    poissons_ratio = 0.33
    type = ComputeIsotropicElasticityTensor
  []
  [strain]
    #Computes the strain, assuming small strains
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  []
  [stress]
    #Computes the stress, using linear elasticity
    type = ComputeLinearElasticStress
  []
  [density_AL]
    #Defines the density of steel
    type = GenericConstantMaterial
    prop_names = density
    prop_values = 6.99e-4 # lbm/in^3
  []
[]

[Preconditioning]
  [SMP]
    #Creates the entire Jacobian, for the Newton solve
    type = SMP
    full = true
  []
[]

[Postprocessors]
  [max_principal_stress]
    type = PointValue
    point = &#x27;0.000000 -1.500000 -4.3&#x27;
    variable = Max_Princ
    use_displaced_mesh = false
  []
  [maxPrincStress]
    type = ElementExtremeValue
    variable = Max_Princ
  []
[]

[Executioner]
  # We solve a steady state problem using Newton&#x27;s iteration
  type = Steady
  solve_type = NEWTON
  nl_rel_tol = 1e-9
  l_max_its = 300
  l_tol = 1e-4
  nl_max_its = 30
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;hypre boomeramg 31&#x27;
[]

[Outputs]
  vtk = true
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#8712f445-d19a-431e-921a-efb7b756d315">(moose/modules/tensor_mechanics/examples/cframe_iga/cframe_iga.i)</a></div></div><div class="card moose-float" id="moose-iga-vtk"><div class="card-content"><picture class="materialboxed moose-image"><img src="../../../large_media/tensor_mechanics/cframe_iga.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text" id="moose-iga-vtk">Maximum principal stress for &quot;c-frame&quot; example utilizing <span class="tooltipped" data-tooltip="Isogeometric Analysis" data-position="top" data-delay="50">IGA</span> in MOOSE.</span></p></div></div></section></section><div class="moose-modal modal" id="0331ba96-9ca8-4cfb-bd24-d05f1d6f74c7"><div class="modal-content"><h4>(moose/modules/tensor_mechanics/examples/cframe_iga/cframe_build.jou)</h4><pre class="moose-pre"><code class="language-text">import step &quot;c-frame.step&quot; heal
remove surface 15 17 21 19 22 23 16 25 18 20 24 26 14 35 38 33 34 36 37 7 8 4 5 6 1 2 10 12 3 9 13 11 80 77 81 88 79 86 90 78 76 89 87 75 91 85 29 28 30 27 31 32 62 60 57 58 48 45 47 50 49 46 54 53 51 56 52 55 41 39 42 43 40 44 68 66  extend 
remove surface 93  extend 
remove surface 94  extend 
webcut volume 1  with sheet extended from surface 99 98 96  preview 
webcut volume 1  with sheet extended from surface 99 98 96  
webcut volume all with sheet extended from surface 92 59  
webcut volume 6 4 3 5 1 2  with sheet extended from surface 67 61  
webcut volume 1 16 2 15  with plane vertex 52  vertex 215  vertex 10  preview 
webcut volume 1 16 2 15  with plane vertex 52  vertex 215  vertex 10  
create vertex on curve 14  fraction 0.5 from start 
create vertex on curve 77  fraction 0.5 from start 
create vertex on curve 32  fraction 0.5 from start 
webcut volume 16 2 15  with plane vertex 270  vertex 269  vertex 271  
webcut volume 1  with plane vertex 270  vertex 269  vertex 271  preview 
webcut volume 1  with plane vertex 270  vertex 269  vertex 271  
delete Vertex 271 269 270
imprint all 
merge all
volume all redistribute nodes off 
volume all scheme Sweep Vector 1 0 0 
volume all scheme Sweep Vector 1 0 0 sweep transform least squares 
volume all autosmooth target on  fixed imprints off  smart smooth off 
volume all size 0.5
mesh volume all
block 1 vol all
sideset 2 surf 194 203 196 
sideset 3 Surface 146 155 148 
block 1 element type hex27 #Quadratic FEA elements
export mesh &quot;CFrame_FEA_05_deg2.e&quot;  overwrite #FEA Export
set uspline vol all deg 2 cont 1
build uspline vol all as 1
fit uspline 1
export uspline 1 exodus &quot;CFrame_IGA_05&quot;</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="8712f445-d19a-431e-921a-efb7b756d315"><div class="modal-content"><h4>(moose/modules/tensor_mechanics/examples/cframe_iga/cframe_iga.i)</h4><pre class="moose-pre"><code class="language-text">[GlobalParams]
  displacements = &#x27;disp_x disp_y disp_z&#x27;
[]

[Mesh]
  [igafile]
    type = FileMeshGenerator
    file = cframe_iga_coarse.e
    clear_spline_nodes = true
  []
[]

[Variables]
  [disp_x]
    order = SECOND
    family = RATIONAL_BERNSTEIN
  []
  [disp_y]
    order = SECOND
    family = RATIONAL_BERNSTEIN
  []
  [disp_z]
    order = SECOND
    family = RATIONAL_BERNSTEIN
  []
[]

[Kernels]
  [TensorMechanics]
#Stress divergence kernels
    displacements = &#x27;disp_x disp_y disp_z&#x27;
   []
[]

[AuxVariables]
    [von_mises]
        #Dependent variable used to visualize the von Mises stress
       order = SECOND
       family = MONOMIAL
    []
    [Max_Princ]
       #Dependent variable used to visualize the Hoop stress
       order = SECOND
       family = MONOMIAL
    []
    [stress_xx]
        order = SECOND
        family = MONOMIAL
    []
    [stress_yy]
        order = SECOND
        family = MONOMIAL
    []
    [stress_zz]
        order = SECOND
        family = MONOMIAL
    []
[]

[AuxKernels]
  [von_mises_kernel]
    #Calculates the von mises stress and assigns it to von_mises
    type = RankTwoScalarAux
    variable = von_mises
    rank_two_tensor = stress
    scalar_type = VonMisesStress
  []
  [MaxPrin]
    type = RankTwoScalarAux
    variable = Max_Princ
    rank_two_tensor = stress
    scalar_type = MaxPrincipal
  []
  [stress_xx]
    type = RankTwoAux
    index_i = 0
    index_j = 0
    rank_two_tensor = stress
    variable = stress_xx
  []
    [stress_yy]
    type = RankTwoAux
    index_i = 1
    index_j = 1
    rank_two_tensor = stress
    variable = stress_yy
  []
  [stress_zz]
    type = RankTwoAux
    index_i = 2
    index_j = 2
    rank_two_tensor = stress
    variable = stress_zz
  []
[]

[BCs]
  [Pressure]
    [load]
      #Applies the pressure
      boundary = &#x27;3&#x27;
      factor = 2000 # psi
    []
  []
  [anchor_x]
    #Anchors the bottom and sides against deformation in the x-direction
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;2&#x27;
    value = 0.0
  []
  [anchor_y]
    #Anchors the bottom and sides against deformation in the y-direction
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;2&#x27;
    value = 0.0
  []
  [anchor_z]
    #Anchors the bottom and sides against deformation in the z-direction
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;2&#x27;
    value = 0.0
  []
[]

[Materials]
  [elasticity_tensor_AL]
    #Creates the elasticity tensor using concrete parameters
    youngs_modulus = 24e6 #psi
    poissons_ratio = 0.33
    type = ComputeIsotropicElasticityTensor
  []
  [strain]
    #Computes the strain, assuming small strains
    type = ComputeSmallStrain
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  []
  [stress]
    #Computes the stress, using linear elasticity
    type = ComputeLinearElasticStress
  []
  [density_AL]
    #Defines the density of steel
    type = GenericConstantMaterial
    prop_names = density
    prop_values = 6.99e-4 # lbm/in^3
  []
[]

[Preconditioning]
  [SMP]
    #Creates the entire Jacobian, for the Newton solve
    type = SMP
    full = true
  []
[]

[Postprocessors]
  [max_principal_stress]
    type = PointValue
    point = &#x27;0.000000 -1.500000 -4.3&#x27;
    variable = Max_Princ
    use_displaced_mesh = false
  []
  [maxPrincStress]
    type = ElementExtremeValue
    variable = Max_Princ
  []
[]

[Executioner]
  # We solve a steady state problem using Newton&#x27;s iteration
  type = Steady
  solve_type = NEWTON
  nl_rel_tol = 1e-9
  l_max_its = 300
  l_tol = 1e-4
  nl_max_its = 30
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27;hypre boomeramg 31&#x27;
[]

[Outputs]
  vtk = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#bb92263f-6611-411d-aa03-59eb083ca2da" class="tooltipped" data-position="left" data-tooltip="Creating IGA Mesh">Creating IGA Mesh</a></li><li><a href="#ac8fc733-27d0-4a22-a8eb-17d087c3efc7" class="tooltipped" data-position="left" data-tooltip="MOOSE - IGA Simulation">MOOSE - IGA Simulation</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script><script type="text/javascript" src="../../../js/sqa_moose.js"></script>